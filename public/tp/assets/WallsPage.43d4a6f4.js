import{S as M,i as Q,s as U,e as h,a as B,t as I,b as w,f as S,g as k,l as L,j as y,u as D,v as J,h as V,k as C,n as A,w as X,p as Y,q as j,N as Z,P as $,C as E,D as v,B as F,I as O,c as z,m as G,o as H}from"./index.c4c2aa46.js";function P(o,e,t){const l=o.slice();return l[15]=e[t],l[17]=t,l}function x(o){let e,t=o[15].name+"",l,n,c,a,_,s;const g=[oe,te],b=[];function i(r,d){return r[5]?0:1}return c=i(o),a=b[c]=g[c](o),{c(){e=h("div"),l=I(t),n=B(),a.c(),_=B(),w(e,"class","svelte-wp0dvg"),v(e,"thisRoom",o[3]===o[15].name),v(e,"connectedRoom",o[1](o[15]))},m(r,d){S(r,e,d),k(e,l),k(e,n),b[c].m(e,null),k(e,_),s=!0},p(r,d){a.p(r,d),d&18&&v(e,"connectedRoom",r[1](r[15]))},i(r){s||(y(a),s=!0)},o(r){C(a),s=!1},d(r){r&&A(e),b[c].d()}}}function ee(o){let e,t=o[15].name+"",l,n;return{c(){e=h("div"),l=I(t),n=B(),w(e,"class","svelte-wp0dvg"),v(e,"thisRoom",o[3]===o[15].name),v(e,"connectedRoom",o[1](o[15]))},m(c,a){S(c,e,a),k(e,l),S(c,n,a)},p(c,a){a&18&&v(e,"connectedRoom",c[1](c[15]))},i:F,o:F,d(c){c&&A(e),c&&A(n)}}}function te(o){let e,t,l,n,c,a;const _=[ne,le],s=[];function g(i,r){return i[0][i[17]]?0:1}t=g(o),l=s[t]=_[t](o);function b(){return o[10](o[17])}return{c(){e=h("button"),l.c(),w(e,"class","svelte-wp0dvg"),v(e,"noWall",!o[0][o[17]])},m(i,r){S(i,e,r),s[t].m(e,null),n=!0,c||(a=L(e,"click",b),c=!0)},p(i,r){o=i;let d=t;t=g(o),t!==d&&(D(),C(s[d],1,1,()=>{s[d]=null}),J(),l=s[t],l||(l=s[t]=_[t](o),l.c()),y(l,1),l.m(e,null)),r&1&&v(e,"noWall",!o[0][o[17]])},i(i){n||(y(l),n=!0)},o(i){C(l),n=!1},d(i){i&&A(e),s[t].d(),c=!1,a()}}}function oe(o){let e;return{c(){e=h("button"),w(e,"class","svelte-wp0dvg"),v(e,"noWall",!o[0][o[17]])},m(t,l){S(t,e,l)},p(t,l){l&1&&v(e,"noWall",!t[0][t[17]])},i:F,o:F,d(t){t&&A(e)}}}function le(o){let e,t,l;return t=new O({props:{name:"add"}}),{c(){e=h("span"),z(t.$$.fragment),w(e,"class","svelte-wp0dvg")},m(n,c){S(n,e,c),G(t,e,null),l=!0},i(n){l||(y(t.$$.fragment,n),l=!0)},o(n){C(t.$$.fragment,n),l=!1},d(n){n&&A(e),H(t)}}}function ne(o){let e,t,l;return t=new O({props:{name:"close"}}),{c(){e=h("span"),z(t.$$.fragment),w(e,"class","svelte-wp0dvg")},m(n,c){S(n,e,c),G(t,e,null),l=!0},i(n){l||(y(t.$$.fragment,n),l=!0)},o(n){C(t.$$.fragment,n),l=!1},d(n){n&&A(e),H(t)}}}function q(o){let e,t,l,n;const c=[ee,x],a=[];function _(s,g){return s[17]===s[4].length-1?0:1}return e=_(o),t=a[e]=c[e](o),{c(){t.c(),l=Z()},m(s,g){a[e].m(s,g),S(s,l,g),n=!0},p(s,g){t.p(s,g)},i(s){n||(y(t),n=!0)},o(s){C(t),n=!1},d(s){a[e].d(s),s&&A(l)}}}function re(o){let e,t,l,n,c,a,_,s,g,b,i=o[4],r=[];for(let f=0;f<i.length;f+=1)r[f]=q(P(o,i,f));const d=f=>C(r[f],1,1,()=>{r[f]=null});return{c(){e=h("section"),t=h("h4"),t.textContent="Tap the walls to add or remove...",l=B(),n=h("div");for(let f=0;f<r.length;f+=1)r[f].c();c=B(),a=h("button"),_=I(o[2]),w(n,"class","rooms svelte-wp0dvg"),w(a,"class","confirm svelte-wp0dvg"),w(e,"class","svelte-wp0dvg")},m(f,p){S(f,e,p),k(e,t),k(e,l),k(e,n);for(let m=0;m<r.length;m+=1)r[m].m(n,null);k(e,c),k(e,a),k(a,_),s=!0,g||(b=L(a,"click",o[11]),g=!0)},p(f,[p]){if(p&123){i=f[4];let m;for(m=0;m<i.length;m+=1){const W=P(f,i,m);r[m]?(r[m].p(W,p),y(r[m],1)):(r[m]=q(W),r[m].c(),y(r[m],1),r[m].m(n,null))}for(D(),m=i.length;m<r.length;m+=1)d(m);J()}(!s||p&4)&&V(_,f[2])},i(f){if(!s){for(let p=0;p<i.length;p+=1)y(r[p]);s=!0}},o(f){r=r.filter(Boolean);for(let p=0;p<r.length;p+=1)C(r[p]);s=!1},d(f){f&&A(e),X(r,f),g=!1,b()}}}function T(o,e){return Array.isArray(o)&&Array.isArray(e)&&o.length===e.length&&o.every((t,l)=>t===e[l])}function se(o,e,t){let l,n,c,a;Y(o,j,u=>t(12,a=u));let{config:_={name:"Room Combining",file:"WallsPage",roomName:"A",walls:[1,1],wallSensor:!1,rooms:[{id:1,name:"A"},{id:2,name:"B"},{id:3,name:"C"}],roomStates:[{id:1,name:"A",configFile:"configs/a.json",walls:[1,0],roomNames:["A"]},{id:2,name:"A",configFile:"configs/a.json",walls:[1,1],roomNames:["A"]},{id:3,name:"A+B",configFile:"configs/a-b.json",walls:[0,1],roomNames:["A","B"]},{id:4,name:"A+B+C",configFile:"configs/a-b-c.json",walls:[0,0],roomNames:["A","B","C"]}]}}=e,s=_.roomName,g=_.rooms,b=_.roomStates,i=_.walls,r=_.wallSensor;function d(u){i[u]===0?t(0,i[u]=1,i):t(0,i[u]=0,i),t(0,i)}function f(){let u=l.configFile;u=u[0]==="/"?u.substring(1):u,u=u.endsWith(".json")?u:`${u}.json`,console.log("config file name",u),t(2,n="Loading.");let N=setInterval(()=>{t(2,n+="."),n.length>12&&t(2,n="Loading.")},250);$(u).then(R=>{setTimeout(()=>{clearInterval(N),E(j,a.config=R,a),E(j,a.router.popup="",a),E(j,a.router.page=a.config.client.startup.page,a)},2e3)})}function p(u){let N;return b.forEach(R=>{T(u,R.walls)&&(N=R)}),N}const m=u=>d(u),W=()=>f();return o.$$set=u=>{"config"in u&&t(8,_=u.config)},o.$$.update=()=>{o.$$.dirty&1&&t(9,l=p(i)),o.$$.dirty&512&&t(2,n=`Confirm room state is ${l.name}`),o.$$.dirty&1&&t(1,c=u=>{let N=!1;return b.forEach(R=>{T(i,R.walls)&&R.roomNames.forEach(K=>{u.name===K&&(N=!0)})}),N}),o.$$.dirty&512&&console.log("currentState",l)},console.log("roomStates",b),[i,c,n,s,g,r,d,f,_,l,m,W]}class ce extends M{constructor(e){super(),Q(this,e,se,re,U,{config:8})}}export{ce as default};
